<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Автосалон</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 0;
        }
        .container {
            margin: 0 auto;
            padding: 20px;
            max-width: 1200px;
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        .filters, .car-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .filter-group, .car-card {
            background-color: #1f1f1f;
            padding: 10px;
            border-radius: 8px;
            flex: 1;
            min-width: 150px;
        }
        .car-card img {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }
        .car-card h3 {
            font-size: 18px;
            margin: 10px 0;
        }
        .car-card p {
            font-size: 14px;
        }
        .btn {
            display: inline-block;
            padding: 8px 16px;
            background-color: #FF9F00;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-top: 10px;
        }
        .btn:hover {
            background-color: #f89c00;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Автосалон</h1>
    <div class="filters">
        <div class="filter-group">
            <label for="carMake">Марка</label>
            <select id="carMake">
                <option value="">Все</option>
                <option value="BMW">BMW</option>
                <option value="Porsche">Porsche</option>
                <!-- Add more options as needed -->
            </select>
        </div>
        <div class="filter-group">
            <label for="carModel">Модель</label>
            <select id="carModel">
                <option value="">Все</option>
                <!-- Options will be populated dynamically -->
            </select>
        </div>
        <div class="filter-group">
            <label for="carPrice">Цена</label>
            <select id="carPrice">
                <option value="">Все</option>
                <option value="5000000">От 5,000,000 ₽</option>
                <option value="10000000">От 10,000,000 ₽</option>
                <!-- Add more price options as needed -->
            </select>
        </div>
        <div class="filter-group">
            <button id="resetFilters" class="btn">Сбросить фильтры</button>
        </div>
    </div>

    <div class="car-list">
        <!-- Car items will be dynamically populated here -->
    </div>
</div>

<script>
    const SPREADSHEET_ID = '1e6MBPZ3vmYdgJRHLwQIw2Ehf7TFSdWycgJ9mYnM0Ahk'; // Google Sheets ID
    const API_KEY = 'AIzaSyB7BDWOi1pICTSaN1SdUsdTKlgW1g-v_Vc'; // Google API Key

    let carData = [];

    function fetchCarData() {
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Наличие?key=${API_KEY}`;
        axios.get(url)
            .then(response => {
                carData = response.data.values.slice(1); // Skip header row
                updateCarList();
            })
            .catch(error => console.error('Error fetching data from Google Sheets:', error));
    }

    function updateCarList() {
        const filteredCars = filterCars();
        const carList = document.querySelector('.car-list');
        carList.innerHTML = '';

        filteredCars.forEach(car => {
            const carCard = document.createElement('div');
            carCard.classList.add('car-card');
            carCard.innerHTML = `
                <img src="${car[0]}" alt="${car[1]} ${car[2]}">
                <h3>${car[1]} ${car[2]}</h3>
                <p>${car[3]} | ${car[4]} | ${car[5]} | ${car[6]} | ${car[7]} | ${car[8]}₽</p>
                <a href="https://t.me/NewTimeAuto_bot?start=${car[9]}" class="btn">Задать вопрос</a>
            `;
            carList.appendChild(carCard);
        });
    }

    function filterCars() {
        const make = document.getElementById('carMake').value.toLowerCase();
        const model = document.getElementById('carModel').value.toLowerCase();
        const price = document.getElementById('carPrice').value;

        return carData.filter(car => {
            const carMake = car[1].toLowerCase();
            const carModel = car[2].toLowerCase();
            const carPrice = parseInt(car[8].replace(/\D/g, ''));

            return (
                (make === '' || carMake.includes(make)) &&
                (model === '' || carModel.includes(model)) &&
                (price === '' || carPrice >= parseInt(price))
            );
        });
    }

    document.getElementById('carMake').addEventListener('change', updateCarList);
    document.getElementById('carModel').addEventListener('change', updateCarList);
    document.getElementById('carPrice').addEventListener('change', updateCarList);
    document.getElementById('resetFilters').addEventListener('click', () => {
        document.getElementById('carMake').value = '';
        document.getElementById('carModel').value = '';
        document.getElementById('carPrice').value = '';
        updateCarList();
    });

    fetchCarData();
</script>

</body>
</html>
